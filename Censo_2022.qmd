---
title: "Análises Censo 2022"
format: pdf
editor: visual
---


```{r, include=FALSE}
estat_colors <- c(
  "#A11D21", "#003366", "#CC9900",
  "#663333", "#FF6600", "#CC9966",
  "#999966", "#006606", "#008091", 
  "#041835", "#666666" )

theme_estat <- function(...) {
  theme <- ggplot2::theme_bw() +
    ggplot2::theme(
      axis.title.y = ggplot2::element_text(colour = "black", size = 12),
      axis.title.x = ggplot2::element_text(colour = "black", size = 12),
      axis.text = ggplot2::element_text(colour = "black", size = 9.5),
      panel.border = ggplot2::element_blank(),
      axis.line = ggplot2::element_line(colour = "black"),
      legend.position = "top",
      ...
    )
  
  return(
    list(
      theme,
      scale_fill_manual(values = estat_colors),
      scale_colour_manual(values = estat_colors)
    )
  )
}
```

```{r, include=FALSE}
library(tidyverse)
library(readxl)
library(sf)
library(geobr)
library(rasterVis)
library(knitr)
```

```{r, echo=FALSE}
Agregados <- read_excel("analise_de_dados/dados/Censo 2022/Agregados_preliminares_por_setores_censitarios_DF.xlsx")

Dicionario <- read_excel("analise_de_dados/dados/Censo 2022/Dicionario_de_dados_agregados_preliminares.xlsx")

malha <- read_sf("analise_de_dados/dados/Censo 2022/DF_Malha_Preliminar_2022/DF_Malha_Preliminar_2022.shp")
```

### Mapa do Distrito Federal com os setores censitários

```{r, echo=FALSE}
plot(malha$geometry)
```

## Análises

### Total de pessoas no DF

```{r, echo=FALSE}
sum(Agregados$v0001) %>%
  kable(col.names = "Total de pessoas no DF")
```

### Total de pessoas por RA

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0001)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
  ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total", title = "10 RA's com maior número total de pessoas") +
  theme_estat()
```
```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0001)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
  ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total", title = "10 RA's com menor número total de pessoas") +
  theme_estat()
```


```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0001)) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", "Total de pessoas"))
```

### Total de domicílios no DF

```{r, echo=FALSE}
sum(Agregados$v0002) %>% 
  kable(col.names = "Total de domícilios no DF")
```

### Total de domicílios por RA

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0002)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com maior número de domicílios") +
  theme_estat()
```


```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0002)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com menor número de domicílios") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0002)) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", "Total de domícilios"))
```

### Total de domicílios particulares no DF

```{r, echo=FALSE}
sum(Agregados$v0003) %>% 
  kable(col.names = "Total de domícilios particulares no DF")
```

### Total de domicílios particulares por RA

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0003)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com maior número de domicílios particulares") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0003)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com menor número de domicílios particulares") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0003)) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", "Total de domícilios particulares"))
```

### Total de domicílios coletivos no DF

```{r, echo=FALSE}
sum(Agregados$v0004) %>% 
  kable(col.names = "Total de domícilios coletivos no DF")
```

### Total de domicílios coletivos por RA

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0004)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com maior número de domicílios coletivos") +
  theme_estat()
```


```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0004)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=3))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com menor número de domicílios coletivos") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0004)) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", "Total de domícilios coletivos"))
```

### Média de moradores em domicílios particulares ocupados no DF

```{r, echo=FALSE}
round(mean(Agregados$v0005), 2) %>% 
  kable(col.names = "Média de moradores em domicílios particulares ocupados no DF")
```

### Média de moradores em domicílios particulares ocupados por RA

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = round(mean(v0005),2)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com maior média de moradores em \ndomicílios particulares ocupados") +
  theme_estat()
```


```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = round(mean(v0005),2)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com maior média de moradores em \ndomicílios particulares ocupados") +
  theme_estat()
```


```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = round(mean(v0005),2)) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", "média de moradores em dom. part. ocupados"))
```

### Total de moradores em domicílios particulares ocupados no DF

```{r, echo=FALSE}
(mean(Agregados$v0005) * sum(Agregados$v0007)) %>% 
  kable(col.names = "Total de moradores em domicílios particulares ocupados no DF")
```

### Total de moradores em domicílios particulares ocupados por RA

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0005*v0007)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com maior número de de moradores\n em domicílios particulares ocupados") +
  theme_estat()
```
```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0005*v0007)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com menor número de de moradores\n em domicílios particulares ocupados") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0005*v0007)) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", " Total de moradores em dom. part. ocupados"))
```

### Percentual de domicílios particulares ocupados imputados no DF

```{r, echo=FALSE}
str_c(round(mean(Agregados$v0006),2),"%") %>% 
  kable(col.names = "Percentual de domicílios particulares ocupados imputados no DF")
```

### Percentual de domicílios particulares ocupados imputados por RA

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = round(mean(v0006),2)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = str_c(Total, "%")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com maior percentual de domicílios\n particulares ocupados imputados") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = round(mean(v0006),2)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = str_c(Total, "%")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com menor percentual de domicílios\n particulares ocupados imputados") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = str_c(round(mean(v0006),2), "%")) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", "Percentual de dom. part. ocupados imputados"))
```

### Total de domicílios particulares ocupado no DF

```{r, echo=FALSE}
sum(Agregados$v0007) %>% 
  kable(col.names = "Total de domícilios particulares ocupados no DF")
```

### Total de domicílios particulares ocupado por RA

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0007)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com maior número de domicílios\n particulares ocupados") +
  theme_estat()
```
```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0007)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com menor número de domicílios\n particulares ocupados") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0007)) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", "Total de dom. part. ocupados"))
```


