---
title: "Análises Censo 2022"
format: pdf
editor: visual
---


```{r, include=FALSE}
estat_colors <- c(
  "#A11D21", "#003366", "#CC9900",
  "#663333", "#FF6600", "#CC9966",
  "#999966", "#006606", "#008091", 
  "#041835", "#666666" )

theme_estat <- function(...) {
  theme <- ggplot2::theme_bw() +
    ggplot2::theme(
      axis.title.y = ggplot2::element_text(colour = "black", size = 12),
      axis.title.x = ggplot2::element_text(colour = "black", size = 12),
      axis.text = ggplot2::element_text(colour = "black", size = 9.5),
      panel.border = ggplot2::element_blank(),
      axis.line = ggplot2::element_line(colour = "black"),
      legend.position = "top",
      ...
    )
  
  return(
    list(
      theme,
      scale_fill_manual(values = estat_colors),
      scale_colour_manual(values = estat_colors)
    )
  )
}
```

```{r, include=FALSE}
library(tidyverse)
library(readxl)
library(sf)
library(geobr)
library(rasterVis)
library(knitr)
```

```{r, echo=FALSE}
Agregados <- read_excel("analise_de_dados/dados/Censo 2022/Agregados_preliminares_por_setores_censitarios_DF.xlsx")

Dicionario <- read_excel("analise_de_dados/dados/Censo 2022/Dicionario_de_dados_agregados_preliminares.xlsx")

malha <- read_sf("analise_de_dados/dados/Censo 2022/DF_Malha_Preliminar_2022/DF_Malha_Preliminar_2022.shp")
```

### Mapa do Distrito Federal com os setores censitários

```{r, echo=FALSE}
plot(malha$geometry)
```

## Análises

### Total de pessoas no DF

```{r, echo=FALSE}
sum(Agregados$v0001) %>%
  format(decimal.mark = ",", big.mark = ".") %>% 
  kable(col.names = "Total de pessoas no DF")
```

### Total de pessoas por RA

```{r, echo=FALSE}
options(scipen = 999)
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0001)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
  ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = format(Total, decimal.mark = ",", big.mark = ".")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total", title = "10 RA's com maior número total de pessoas") +
  theme_estat()
```
Em 1969, com apenas nove anos de fundação, Brasília já tinha 79.128 favelados, que moravam em 14.607 barracos. Atualmente, Ceilândia é a RA mais populosa do Distrito Federal. A Novacap fez a demarcação em 97 dias, com início em 15 de outubro de 1970, assim foi criada a Campanha de Erradicação das Invasões – CEI.
[Fonte](https://www.ceilandia.df.gov.br/2019/11/08/historia-de-ceilandia/)

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0001)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
  ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = format(Total, decimal.mark = ",", big.mark = ".")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total", title = "10 RA's com menor número total de pessoas") +
  theme_estat()
```
Já o SIA, é uma RA recente, criada em julho de 2005 para abrigar pequenas indústrias e depósitos. É dependente de outras RAs, pois não possui hospitais ou postos de saúde públicos, obrigando a população dependente desse tipo de serviço a se deslocar às outras regiões.
[Fonte](https://www.codeplan.df.gov.br/sia-uma-regiao-peculiar/#:~:text=O%20SIA%20foi%20criado%20em,fundamentais%20para%20o%20Distrito%20Federal) 

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0001)) %>% 
  mutate(Total = format(Total, decimal.mark = ",", big.mark = ".")) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", "Total de pessoas"))
```

### Total de domicílios no DF


Domicílio, segundo o Instituto brasileiro de Geografia e Estatística, é o local estruturalmente separado e independente que se destina a servir de habitação a uma ou mais pessoas, ou que esteja sendo utilizado como tal. Os critérios essenciais desta definição são os de separação e independência. Entende-se por separação o local de habitação limitado por paredes, muros ou cercas, coberto por um teto, permitindo a uma ou mais pessoas que nele habitam isolar-se das demais, com a finalidade de dormir, preparar e/ou consumir seus alimentos e proteger-se do meio ambiente, arcando, total ou parcialmente, com suas despesas de alimentação ou moradia. Por independência se entende quando o local de habitação tem acesso direto, permitindo a seus moradores entrar e sair sem necessidade de passar por locais de moradia de outras pessoas. Só caracteriza-se corretamente domicílio quando forem atendidos simultaneamente os critérios de separação e independência.


```{r, echo=FALSE}
sum(Agregados$v0002) %>% 
  format(decimal.mark = ",", big.mark = ".") %>%
  kable(col.names = "Total de domícilios no DF")
```

### Total de domicílios por RA

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0002)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = format(Total, decimal.mark = ",", big.mark = ".")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com maior número de domicílios") +
  theme_estat()
```


```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0002)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = format(Total, decimal.mark = ",", big.mark = ".")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com menor número de domicílios") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0002)) %>% 
  mutate(Total = format(Total, decimal.mark = ",", big.mark = ".")) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", "Total de domícilios"))
```

### Total de domicílios particulares no DF

Domicílio particular, segundo o IBGE, é o domicílio em que o relacionamento entre seus ocupantes é ditado por laços de parentesco, de dependência doméstica ou por normas de convivência.


```{r, echo=FALSE}
sum(Agregados$v0003) %>% 
  format(decimal.mark = ",", big.mark = ".") %>%
  kable(col.names = "Total de domícilios particulares no DF")
```

### Total de domicílios particulares por RA

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0003)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = format(Total, decimal.mark = ",", big.mark = ".")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com maior número de\n domicílios particulares") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0003)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = format(Total, decimal.mark = ",", big.mark = ".")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com menor número de\n domicílios particulares") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0003)) %>%
  mutate(Total = format(Total, decimal.mark = ",", big.mark = ".")) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", "Total de domícilios particulares"))
```

### Total de domicílios coletivos no DF

Domicílio coletivo, segundo o IBGE, é o domicílio em que a relação entre as pessoas que nele habitam é restrita a normas de subordinação administrativa, como hotéis, pensões, presídios, penitenciárias, quartéis, postos militares, asilos, orfanatos, conventos, hospitais e clínicas (com internação), alojamento de trabalhadores, motéis, campings etc.
[Fonte](https://censo2010.ibge.gov.br/materiais/guia-do-censo/glossario.html#:~:text=Domic%C3%ADlio%20coletivo%20%2D%20%C3%89%20o%20domic%C3%ADlio,%2C%20alojamento%20de%20trabalhadores%2C%20mot%C3%A9is%2C)

```{r, echo=FALSE}
sum(Agregados$v0004) %>% 
  kable(col.names = "Total de domícilios coletivos no DF")
```

### Total de domicílios coletivos por RA

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0004)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com maior número de domicílios coletivos") +
  theme_estat()
```
Acreditamos que o Plano Piloto é a RA com maior número de domicílios coletivos, uma vez que possui a maior infraestrutura de hotéis, hospitais e cli1nicas(com internação).

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0004)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=3))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com menor número de domicílios coletivos") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0004)) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", "Total de domícilios coletivos"))
```

### Média de moradores em domicílios particulares ocupados no DF

```{r, echo=FALSE}
round(mean(Agregados$v0005), 2) %>% 
  kable(col.names = "Média de moradores em domicílios particulares ocupados no DF")
```

### Média de moradores em domicílios particulares ocupados por RA

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = round(mean(v0005),2)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Média de moradores", title = "10 RA's com maior média de moradores em \ndomicílios particulares ocupados") +
  theme_estat()
```


```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = round(mean(v0005),2)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = Total) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Média de moradores", title = "10 RA's com menor média de moradores em \ndomicílios particulares ocupados") +
  theme_estat()
```


```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = round(mean(v0005),2)) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", "média de moradores em dom. part. ocupados"))
```


Acreditamos que o número de moradores por domicílio por RA se relaciona ao tipo de moradia nessas regiões, as RA com predominância de casas possuem maior quantidade de moradores por domicílio, e as com predominância de apartamentos, menor quantidade de moradores por domicílio, sendo o Sudoeste, SIA e Plano Piloto regiões com kitnets


### Total de moradores em domicílios particulares ocupados no DF

```{r, echo=FALSE}
(mean(Agregados$v0005) * sum(Agregados$v0007)) %>% 
  format(decimal.mark = ",", big.mark = ".") %>%
  kable(col.names = "Total de moradores em domicílios particulares ocupados no DF")
```

### Total de moradores em domicílios particulares ocupados por RA

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0005*v0007)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = format(Total, decimal.mark = ",", big.mark = ".")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de moradores", title = "10 RA's com maior número de de moradores\n em domicílios particulares ocupados") +
  theme_estat()
```
```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0005*v0007)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = format(Total, decimal.mark = ",", big.mark = ".")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de moradores", title = "10 RA's com menor número de de moradores\n em domicílios particulares ocupados") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0005*v0007)) %>% 
  mutate(Total = format(Total, decimal.mark = ",", big.mark = ".")) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", " Total de moradores em dom. part. ocupados"))
```

### Percentual de domicílios particulares ocupados imputados no DF

```{r, echo=FALSE}
str_c(round(mean(Agregados$v0006),2),"%") %>% 
  kable(col.names = "Percentual de domicílios particulares ocupados imputados no DF")
```

### Percentual de domicílios particulares ocupados imputados por RA

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = round(mean(v0006),2)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = str_c(Total, "%")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Percentual de domícilios", title = "10 RA's com maior percentual de domicílios\n particulares ocupados imputados") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = round(mean(v0006),2)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = str_c(Total, "%")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Percentual de domícilios", title = "10 RA's com menor percentual de domicílios\n particulares ocupados imputados") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = str_c(round(mean(v0006),2), "%")) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", "Percentual de dom. part. ocupados imputados"))
```

### Total de domicílios particulares ocupado no DF

```{r, echo=FALSE}
sum(Agregados$v0007) %>% 
  format(decimal.mark = ",", big.mark = ".") %>%
  kable(col.names = "Total de domícilios particulares ocupados no DF")
```

### Total de domicílios particulares ocupado por RA

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0007)) %>% 
  arrange(desc(Total)) %>% 
  head(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=T), y = Total, label = format(Total, decimal.mark = ",", big.mark = ".")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com maior número de domicílios\n particulares ocupados") +
  theme_estat()
```
```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0007)) %>% 
  arrange(desc(Total)) %>% 
  tail(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, Total, .desc=F), y = Total, label = format(Total, decimal.mark = ",", big.mark = ".")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Total de domícilios", title = "10 RA's com menor número de domicílios\n particulares ocupados") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>%
  group_by(NM_SUBDIST) %>% 
  summarise(Total = sum(v0007)) %>% 
  mutate(Total = format(Total, decimal.mark = ",", big.mark = ".")) %>% 
  arrange(desc(Total)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", "Total de dom. part. ocupados"))
```


### Número de Pessoas por km2 no DF

```{r, echo=FALSE}
round((sum(Agregados$v0001)/sum(Agregados$AREA_KM2)),2) %>% 
  format(decimal.mark = ",", big.mark = ".") %>%
  kable(col.names = "Número de Pessoas por km2 no DF")
```


### Número de Pessoas por km^2 em cada RA

```{r, echo=FALSE}
Agregados %>% 
  mutate(pessoas_km = v0001/AREA_KM2) %>% 
  group_by(NM_SUBDIST) %>% 
  summarise(média = round(mean(pessoas_km), 2)) %>% 
  arrange(desc(média)) %>% 
  head(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, média, .desc=T), y = média, label = format(média, decimal.mark = ",", big.mark = ".")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Pessoas por km2", title = "10 RA's com maior número de Pessoas por km2") +
  theme_estat()
```
```{r, echo=FALSE}
Agregados %>% 
  mutate(pessoas_km = v0001/AREA_KM2) %>% 
  group_by(NM_SUBDIST) %>% 
  summarise(média = round(mean(pessoas_km), 2)) %>% 
  arrange(desc(média)) %>% 
  tail(10) %>% 
ggplot() +
  aes(x = fct_reorder(NM_SUBDIST, média, .desc=F), y = média, label = format(média, decimal.mark = ",", big.mark = ".")) +
  geom_bar(stat = "identity", fill = "dark blue", width = 0.7) +
  geom_text(
    position = position_dodge(width = .9),
    vjust = -0.5, #hjust = .5,
    size = 2
  ) + 
  scale_x_discrete(guide = guide_axis(n.dodge=2))+
  labs(x = "Região Administrativa", y = "Pessoas por km^2", title = "10 RA's com maior número de Pessoas por km2") +
  theme_estat()
```

```{r, echo=FALSE}
Agregados %>% 
  mutate(pessoas_km = v0001/AREA_KM2) %>% 
  group_by(NM_SUBDIST) %>% 
  summarise(média = round(mean(pessoas_km),2)) %>% 
  mutate(média = format(média, decimal.mark = ",", big.mark = ".")) %>% 
  arrange(desc(média)) %>% 
  mutate("n" = row_number()) %>% 
  select(c(3,1,2)) %>% 
  kable(col.names = c("", "RA", "Pessoas por km2"))
```

